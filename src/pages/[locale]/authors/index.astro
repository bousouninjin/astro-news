---
import { getEntryBySlug } from "@/i18n/content";
import { DEFAULT_LOCALE, LOCALES } from "@/i18n/config";
import { localizePath } from "@/i18n/paths";
import Info from "@/assets/svgs/info.astro";
import AuthorCard from "@/components/cards/authorCard.astro";
import ListLayout from "@/layouts/list.astro";
import { authorsHandler } from "@/lib/handlers/authors";

export const getStaticPaths = () =>
  LOCALES.filter((locale) => locale !== DEFAULT_LOCALE).map((locale) => ({
    params: { locale },
  }));

const locale = Astro.currentLocale ?? Astro.params.locale;
const entry = await getEntryBySlug("views", "authors", locale);

if (!entry) {
  return Astro.redirect(localizePath(locale, "/404"));
}

const authors = await authorsHandler.allAuthors(locale);

const [HEADER, ATTENTION] = entry.data.blocks;
---

<ListLayout header={HEADER.title} entry={entry}>
  <section role="alert" class="alert alert-info mb-4 bg-info/60">
    <Info size="16" />
    <span>{ATTENTION.description}</span>
  </section>
  <section class="flex-1">
    <ul class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6 md:gap-4">
      {authors.map((author) => <AuthorCard author={author} />)}
    </ul>
  </section>
</ListLayout>
