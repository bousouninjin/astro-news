---
import { localizePath, stripLocaleFromPath } from "@/i18n/paths";

type Props = {
  item: {
    href: string;
    label: string;
    paginated?: boolean;
  };
};
const currentPath = stripLocaleFromPath(Astro.url.pathname);
const { item } = Astro.props;
const locale = Astro.currentLocale;

function isActive(href: string, path: string) {
  if (href === "/") {
    return path === "/";
  }
  return path === href || path.startsWith(`${href}/`);
}

function formatHref(href: string, paginated?: boolean) {
  const localized = localizePath(locale, href);
  return paginated ? `${localized}/1` : localized;
}
---

<li
  class:list={[
    "relative after:absolute after:-bottom-2 after:left-0 after:h-[1.5px] after:w-full after:transition-all after:duration-300",
    isActive(item.href, currentPath)
      ? "after:bg-base-content pointer-events-none"
      : "after:bg-transparent",
  ]}
>
  <a href={formatHref(item.href, item.paginated)} aria-label={item.label}>
    {item.label}
  </a>
</li>
